<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Welcome Back - Sign In</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      @keyframes gradient-animation {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      .bg-gradient-animated {
        background-size: 200% 200%;
        animation: gradient-animation 12s ease infinite;
      }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://aistudiocdn.com/react@^19.1.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.1.1/",
    "react/": "https://aistudiocdn.com/react@^19.1.1/",
    "@supabase/supabase-js": "https://aistudiocdn.com/@supabase/supabase-js@^2.58.0"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body class="bg-gray-100">
    <div id="root"></div>
    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useCallback, useMemo } from 'https://esm.sh/react@18.2.0';
        import ReactDOM from 'https://esm.sh/react-dom@18.2.0/client';

        const { createClient } = window.supabase;
        const supabase = createClient(
          "https://jxlcchbvawbkmzfigqmd.supabase.co",
          "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp4bGNjaGJ2YXdia216ZmlncW1kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0ODA5OTgsImV4cCI6MjA3NDA1Njk5OH0.VBMshOHnWYkdSeDZ6asGwO2CaROp_tgQncQ-EWXF-ho"
        );
        
        const EyeIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className} aria-hidden="true">
            <path strokeLinecap="round" strokeLinejoin="round" d="M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.432 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z" />
            <path strokeLinecap="round" strokeLinejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
          </svg>
        );

        const EyeSlashIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className} aria-hidden="true">
            <path strokeLinecap="round" strokeLinejoin="round" d="M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.523 10.523 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.243 4.243L6.228 6.228" />
          </svg>
        );

        const GoogleIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" className={className} aria-hidden="true">
            <path fill="#FFC107" d="M43.611 20.083H42V20H24v8h11.303c-1.649 4.657-6.08 8-11.303 8c-6.627 0-12-5.373-12-12s5.373-12 12-12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C12.955 4 4 12.955 4 24s8.955 20 20 20s20-8.955 20-20c0-1.341-.138-2.65-.389-3.917z" />
            <path fill="#FF3D00" d="M6.306 14.691l6.571 4.819C14.655 15.108 18.961 12 24 12c3.059 0 5.842 1.154 7.961 3.039l5.657-5.657C34.046 6.053 29.268 4 24 4C16.318 4 9.656 8.337 6.306 14.691z" />
            <path fill="#4CAF50" d="M24 44c5.166 0 9.86-1.977 13.409-5.192l-6.19-5.238C29.211 35.091 26.715 36 24 36c-5.223 0-9.657-3.657-11.303-8H6.306C9.656 39.663 16.318 44 24 44z" />
            <path fill="#1976D2" d="M43.611 20.083H42V20H24v8h11.303c-.792 2.237-2.231 4.166-4.087 5.571l6.19 5.238C44.272 34.637 48 29.896 48 24c0-1.341-.138-2.65-.389-3.917z" />
          </svg>
        );

        const LogoIcon = ({ className }) => (
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth="1.5" stroke="currentColor" className={className} aria-hidden="true">
            <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 5.25a3 3 0 013 3m3 0a6 6 0 01-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1121.75 8.25z" />
          </svg>
        );

        const Spinner = () => (
          <svg className="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" aria-label="Loading" role="status">
            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
        );

        const App = () => {
            const [formState, setFormState] = useState({
                email: '',
                password: '',
            });
            const [errors, setErrors] = useState({});
            const [showPassword, setShowPassword] = useState(false);
            const [isLoading, setIsLoading] = useState(false);
            const [isCardVisible, setIsCardVisible] = useState(false);

            useEffect(() => {
                setIsCardVisible(true);
            }, []);

            const validate = useCallback(() => {
                const newErrors = {};
                if (!formState.email) {
                    newErrors.email = 'Email is required';
                } else if (!/\S+@\S+\.\S+/.test(formState.email)) {
                    newErrors.email = 'Email address is invalid';
                }

                if (!formState.password) {
                    newErrors.password = 'Password is required';
                } else if (formState.password.length < 8) {
                    newErrors.password = 'Password must be at least 8 characters';
                }
                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            }, [formState]);

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormState(prevState => ({ ...prevState, [name]: value }));
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!validate()) {
                    return;
                }

                setIsLoading(true);
                const { email, password } = formState;

                const { data, error } = await supabase.auth.signInWithPassword({
                    email,
                    password,
                });

                setIsLoading(false);

                if (error) {
                    alert("Error: " + error.message);
                    return;
                }

                const user = data?.user;
                if (!user) {
                    alert("Login failed: no user data returned.");
                    return;
                }

                if (!user.email_confirmed_at) {
                    alert("Please verify your email first. Check your inbox.");
                    await supabase.auth.signOut();
                    return;
                }
                
                window.location.href = window.location.origin + "/Vionexx/profile.html";
            };
            
            const handleGoogleButtonClick = async () => {
                setIsLoading(true);
                const { error } = await supabase.auth.signInWithOAuth({
                    provider: "google",
                    options: {
                        redirectTo: window.location.origin + "/Vionexx/profile.html"
                    }
                });
                if (error) {
                    alert("Google login error: " + error.message);
                    setIsLoading(false);
                }
            };

            const isFormValid = useMemo(() => {
                return (
                    formState.email !== '' &&
                    /\S+@\S+\.\S+/.test(formState.email) &&
                    formState.password !== '' &&
                    formState.password.length >= 8
                );
            }, [formState]);

            return (
              <main className="relative min-h-screen w-full flex items-center justify-center p-4 overflow-hidden">
                <div className="absolute inset-0 bg-gradient-to-br from-orange-200 via-orange-400 to-yellow-200 bg-gradient-animated motion-safe:animate-[gradient-animation_12s_ease_infinite] motion-reduce:animate-none"></div>
                <div 
                  className={`relative z-10 w-full max-w-md bg-white/80 backdrop-blur-sm rounded-2xl shadow-2xl p-6 sm:p-8 transition-all duration-700 ease-in-out ${isCardVisible ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-8'}`}
                >
                  <div className="text-center mb-8">
                    <div className="inline-block p-2 bg-orange-100 rounded-full mb-4">
                      <LogoIcon className="w-8 h-8 text-orange-500" />
                    </div>
                    <h1 className="text-3xl font-bold text-gray-800">Welcome Back</h1>
                    <p className="text-gray-600 mt-2">Sign in to continue to YourApp</p>
                  </div>
                  
                  <form onSubmit={handleSubmit} noValidate className="space-y-6">
                    <div className="relative">
                      <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-1">Email Address</label>
                      <input
                        type="email"
                        id="email"
                        name="email"
                        value={formState.email}
                        onChange={handleChange}
                        placeholder="you@example.com"
                        aria-label="Email Address"
                        aria-invalid={!!errors.email}
                        aria-describedby="email-error"
                        disabled={isLoading}
                        className={`w-full px-4 py-3 border rounded-lg bg-gray-50 focus:outline-none focus:ring-2 transition-shadow ${errors.email ? 'border-red-500 focus:ring-red-400' : 'border-gray-300 focus:ring-orange-400'}`}
                      />
                      {errors.email && <p id="email-error" className="text-red-600 text-xs mt-1">{errors.email}</p>}
                    </div>

                    <div className="relative">
                      <div className="flex justify-between items-center mb-1">
                        <label htmlFor="password" className="block text-sm font-medium text-gray-700">Password</label>
                        <a href="#" className="text-xs font-medium text-orange-600 hover:text-orange-500">Forgot password?</a>
                      </div>
                      <div className="relative">
                        <input
                          type={showPassword ? 'text' : 'password'}
                          id="password"
                          name="password"
                          value={formState.password}
                          onChange={handleChange}
                          placeholder="********"
                          aria-label="Password"
                          aria-invalid={!!errors.password}
                          aria-describedby="password-error"
                          disabled={isLoading}
                          className={`w-full px-4 py-3 border rounded-lg bg-gray-50 focus:outline-none focus:ring-2 transition-shadow ${errors.password ? 'border-red-500 focus:ring-red-400' : 'border-gray-300 focus:ring-orange-400'}`}
                        />
                        <button
                          type="button"
                          onClick={() => setShowPassword(!showPassword)}
                          className="absolute inset-y-0 right-0 px-3 flex items-center text-gray-500 hover:text-gray-700"
                          aria-label={showPassword ? 'Hide password' : 'Show password'}
                          disabled={isLoading}
                        >
                          {showPassword ? <EyeSlashIcon className="h-5 w-5" /> : <EyeIcon className="h-5 w-5" />}
                        </button>
                      </div>
                      {errors.password && <p id="password-error" className="text-red-600 text-xs mt-1">{errors.password}</p>}
                    </div>
                    
                    <button
                      type="submit"
                      disabled={isLoading || !isFormValid}
                      className="w-full bg-[#FF6A00] text-white font-bold py-3 px-4 rounded-lg hover:bg-orange-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 flex items-center justify-center"
                      aria-live="polite"
                    >
                      {isLoading ? <Spinner /> : 'Sign In'}
                    </button>
                  </form>

                  <div className="my-6 flex items-center">
                    <hr className="flex-grow border-gray-300" />
                    <span className="mx-4 text-gray-500 text-sm font-medium">OR</span>
                    <hr className="flex-grow border-gray-300" />
                  </div>

                  <button
                    type="button"
                    onClick={handleGoogleButtonClick}
                    disabled={isLoading}
                    className="w-full flex items-center justify-center gap-3 py-3 px-4 border border-[#FF6A00] rounded-lg bg-white hover:bg-orange-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 disabled:opacity-50 transition-colors duration-300"
                    aria-label="Sign in with Google"
                    role="button"
                  >
                    <GoogleIcon className="w-5 h-5" />
                    <span className="text-sm font-bold text-gray-800">Sign in with Google</span>
                  </button>

                  <p className="text-center text-sm text-gray-600 mt-8">
                    Don't have an account? <a href="/Vionexx/signup.html" className="font-medium text-orange-600 hover:text-orange-500">Sign up</a>
                  </p>
                </div>
              </main>
            );
        };

        const rootElement = document.getElementById('root');
        if (!rootElement) {
          throw new Error("Could not find root element to mount to");
        }

        const root = ReactDOM.createRoot(rootElement);
        root.render(
          <React.StrictMode>
            <App />
          </React.StrictMode>
        );
    </script>
<script type="module" src="/index.tsx"></script>
</body>
</html>
